{
  "summary": {
    "title": "Demo Threat Model",
    "owner": "",
    "description": "A sample model of a web application, with a queue-decoupled background process.",
    "id": ""
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "cells": [
          {
            "position": {
              "x": 685,
              "y": 420
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Worker Config"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 1,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "4c0f56ec-cc24-4c71-9b47-3f362353a98a"
                },
                {
                  "group": "right",
                  "id": "26689211-9eb1-414f-8eff-66ebed64fc11"
                },
                {
                  "group": "bottom",
                  "id": "5f61b27a-eabc-48fd-934e-9bbe7907cabf"
                },
                {
                  "group": "left",
                  "id": "16c5e2d4-214a-406d-83ef-fecd3d250477"
                }
              ]
            },
            "id": "a78cb4c9-4773-467e-9f4c-479b0c44debb",
            "data": {
              "name": "Worker Config",
              "description": "",
              "type": "tm.Store",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "status": "Open",
                  "severity": "High",
                  "mitigation": "Encrypt the DB credentials in the configuration file.\n\nExpire and replace the DB credentials regularly.",
                  "description": "The Background Worker configuration stores the credentials used by the worker to access the DB. An attacker could compromise the Background Worker and get access to the DB credentials.",
                  "title": "Accessing DB credentials",
                  "type": "Information disclosure",
                  "modelType": "STRIDE",
                  "id": "7df716cd-a982-48a5-b4ed-800ccb670734"
                }
              ],
              "hasOpenThreats": true,
              "isALog": false,
              "storesCredentials": true,
              "isEncrypted": false,
              "isSigned": false
            }
          },
          {
            "position": {
              "x": 290,
              "y": 420
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Database"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 2,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "843c1855-1b01-4340-b9bf-4d945020c6c8"
                },
                {
                  "group": "right",
                  "id": "b53f4db2-5325-4ef5-9716-9bc3b529bc89"
                },
                {
                  "group": "bottom",
                  "id": "f5a0a9d7-918d-4eea-b40d-619b1c960256"
                },
                {
                  "group": "left",
                  "id": "ac104e9c-ae82-4532-aa2b-58621cf3f837"
                }
              ]
            },
            "id": "4f9ecf52-ec3e-4258-942c-742e2df220bb",
            "data": {
              "name": "Database",
              "description": "",
              "type": "tm.Store",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "description": "An attacker could make an query call on the DB,",
                  "title": "Unauthorised access",
                  "type": "Information disclosure",
                  "mitigation": "Require all queries to be authenticated.",
                  "modelType": "STRIDE",
                  "id": "21fc4b20-ca29-4891-9691-d8f0331b2a11"
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "description": "An attacker could obtain the DB credentials and use them to make unauthorised queries.",
                  "title": "Credential theft",
                  "type": "Information disclosure",
                  "mitigation": "Use a firewall to restrict access to the DB to only the Background Worker IP address.",
                  "modelType": "STRIDE",
                  "id": "e12765bf-ec61-47d8-8e9f-6bb3f5adab47"
                }
              ],
              "hasOpenThreats": true,
              "isALog": true,
              "storesCredentials": false,
              "isEncrypted": false,
              "isSigned": false
            }
          },
          {
            "position": {
              "x": 40,
              "y": 420
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Web Application Config"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": "4 3"
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": "4 3"
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 3,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "f16d2664-1cc0-4dfa-ad5f-809dd4e640c0"
                },
                {
                  "group": "right",
                  "id": "058c158d-8ae2-415f-96d4-ee1d0bb088b2"
                },
                {
                  "group": "bottom",
                  "id": "686a41ba-92d3-41bf-9659-1d6021932ba7"
                },
                {
                  "group": "left",
                  "id": "2f6e8f87-139f-47d3-a0de-78b55103cdb7"
                }
              ]
            },
            "id": "1677fe5b-b403-488e-a270-56494842cd9d",
            "data": {
              "name": "Web Application Config",
              "description": "",
              "type": "tm.Store",
              "isTrustBoundary": false,
              "outOfScope": true,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "status": "Open",
                  "severity": "High",
                  "title": "Credentials should be encrypted",
                  "type": "Information disclosure",
                  "description": "The Web Application Config stores credentials used by the Web App to access the message queue. These could be stolen by an attacker and used to read confidential data or place poison message on the queue.",
                  "mitigation": "The Message Queue credentials should be encrypted.",
                  "modelType": "STRIDE",
                  "id": "aaea0238-2984-4b25-8268-3798e63bed34"
                }
              ],
              "hasOpenThreats": true,
              "isALog": false,
              "storesCredentials": true,
              "isEncrypted": false,
              "isSigned": false
            }
          },
          {
            "position": {
              "x": 600,
              "y": 13
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Message Queue"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 4,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "627c292a-1480-4cd6-8a00-503e8e0b0f7b"
                },
                {
                  "group": "right",
                  "id": "ddbb7e93-8d74-44cb-a221-01738d34be0d"
                },
                {
                  "group": "bottom",
                  "id": "bbeed05f-9fb0-407b-8bc6-0c19b0b47ce7"
                },
                {
                  "group": "left",
                  "id": "7d5ce484-6666-4b4a-9179-f8d5ed600add"
                }
              ]
            },
            "id": "9b63b79c-6225-4175-847d-971ca8bfd0a8",
            "data": {
              "name": "Message Queue",
              "description": "",
              "type": "tm.Store",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "status": "Open",
                  "severity": "Low",
                  "title": "Message secrecy",
                  "type": "Information disclosure",
                  "description": "The data flow between the Web Application and the Background Worker is not point-to-point and therefore end-to-end secrecy cannot be provided at the transport layer. Messages could be read by an attacker at rest in the Message Queue.",
                  "mitigation": "Use message level encryption for high sensitivity data (e.g. security tokens) in messages.",
                  "modelType": "STRIDE",
                  "id": "7bc090cc-50a1-44aa-8481-5e4daaa6d8ba"
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "Message tampering",
                  "type": "Tampering",
                  "description": "Messages on the queue could be tampered with, causing incorrect processing by the Background Worker.",
                  "mitigation": "Sign all queue messages at the Web Server. Validate the message signature at the Background Worker and reject any message with a missing or invalid signature. Log any failed messages.",
                  "modelType": "STRIDE",
                  "id": "52ba8c1d-8376-4ede-942d-e575d71eaef5"
                },
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "title": "Fake messages could be placed on the queue",
                  "type": "Spoofing",
                  "description": "An attacker could put a fake message on queue, causing the Background Worker to do incorrect processing.",
                  "mitigation": "Restrict access to the queue to the IP addresses of the Web Server and Background Worker.\n\nImplement authentication on the queue endpoint.",
                  "modelType": "STRIDE",
                  "id": "b917c6dd-e2d5-455c-8b81-61407126abfa"
                }
              ],
              "hasOpenThreats": true,
              "isALog": false,
              "storesCredentials": false,
              "isEncrypted": false,
              "isSigned": false
            }
          },
          {
            "position": {
              "x": 685,
              "y": 180
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Background\nWorker Process"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 5,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "0be6d741-76b2-4ca0-99cc-e8a207670847"
                },
                {
                  "group": "right",
                  "id": "8ab58ebf-dd5e-4fe8-b51b-86f6461af9c8"
                },
                {
                  "group": "bottom",
                  "id": "86173561-17fd-4ada-89df-aaac3ebd18d0"
                },
                {
                  "group": "left",
                  "id": "1a168ff9-1dec-4307-93e0-4825cf592b47"
                }
              ]
            },
            "id": "ea29d570-adc5-4a89-8789-8b26af9c8a96",
            "data": {
              "name": "Background\nWorker Process",
              "description": "",
              "type": "tm.Process",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "Poison messages 1",
                  "type": "Denial of service",
                  "description": "An attacker could generate a malicious message that the Background Worker cannot process.",
                  "mitigation": "Implement a poison message queue where messages are placed after a fixed number of retries.",
                  "modelType": "STRIDE",
                  "id": "1468b37f-3ff9-4079-8767-f33bbfe0a887"
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "mitigation": "Validate the content of all messages, before processing. Reject any message that have invalid content and log the rejection. Do not log the malicious content - instead log a description of the error.",
                  "type": "Denial of service",
                  "title": "Poison messages 2",
                  "description": "An attacker could generate a malicious message that the Background Worker cannot process.",
                  "modelType": "STRIDE",
                  "id": "3c8033db-0e51-42c0-afd0-d01d2ced4a14"
                }
              ],
              "hasOpenThreats": true
            }
          },
          {
            "position": {
              "x": 220,
              "y": 180
            },
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Web\nApplication"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 6,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "1d14a047-dd9b-4abc-951f-a0ced6920dc2"
                },
                {
                  "group": "right",
                  "id": "650bc030-79bb-4ce0-bba8-5d7619e23587"
                },
                {
                  "group": "bottom",
                  "id": "613bd623-fbc2-4078-8d24-0d09b729cbaa"
                },
                {
                  "group": "left",
                  "id": "692e8f95-2b70-405f-8204-83f1f96a66c4"
                }
              ]
            },
            "id": "e825227b-d35f-4cee-883b-92a10a3b83a7",
            "data": {
              "name": "Web\nApplication",
              "description": "",
              "type": "tm.Process",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [],
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 10,
              "y": 30
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Browser"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 7,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "8ef9fcb6-714d-4aeb-9921-995115d03b2f"
                },
                {
                  "group": "right",
                  "id": "a3d3ea5a-cc25-4a6f-95ee-c61afd4246f9"
                },
                {
                  "group": "bottom",
                  "id": "b6318262-d866-4d26-ba78-c8cf0724ff70"
                },
                {
                  "group": "left",
                  "id": "bf18592f-fd02-4625-bb22-778a93457506"
                }
              ]
            },
            "id": "8d7b0f97-6e4f-453d-95ee-8890baea4f12",
            "data": {
              "name": "Browser",
              "description": "",
              "type": "tm.Actor",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [],
              "hasOpenThreats": false,
              "providesAuthentication": false
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "targetMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "Put Message",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": 0.5
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Put Message",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "status": "Open",
                  "severity": "High",
                  "description": "These requests are made over the public internet and could be intercepted by an attacker.",
                  "title": "Data flow should use HTTP/S",
                  "type": "Information disclosure",
                  "mitigation": "The requests should require HTTP/S. This will provide confidentiality and integrity. HTTP should not be supported.",
                  "modelType": "STRIDE",
                  "id": "f8cc4477-653f-4e4a-a0cb-7b90f046fd7b"
                }
              ],
              "isTrustBoundary": false
            },
            "id": "5fb8fa2d-df85-40cb-8b2a-5c49764d6a52",
            "source": {
              "cell": "e825227b-d35f-4cee-883b-92a10a3b83a7"
            },
            "target": {
              "cell": "9b63b79c-6225-4175-847d-971ca8bfd0a8"
            },
            "vertices": [
              {
                "x": 351,
                "y": 120
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "targetMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "Message",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": 0.5
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Message",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "status": "Open",
                  "severity": "High",
                  "mitigation": "The requests should require HTTP/S. This will provide confidentiality and integrity. HTTP should not be supported.",
                  "type": "Information disclosure",
                  "title": "Data flow should use HTTP/S",
                  "description": "These requests are made over the public internet and could be intercepted by an attacker.",
                  "modelType": "STRIDE",
                  "id": "2fcfb064-6a08-4771-9d9d-342639d63d7b"
                }
              ],
              "isTrustBoundary": false
            },
            "id": "3a598d7e-7a57-4e28-9ecf-ee48b9b97a0e",
            "source": {
              "cell": "9b63b79c-6225-4175-847d-971ca8bfd0a8"
            },
            "target": {
              "cell": "ea29d570-adc5-4a89-8789-8b26af9c8a96"
            },
            "vertices": [
              {
                "x": 630,
                "y": 130
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "targetMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "Worker Query Results",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": 0.5
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Worker Query Results",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "status": "Open",
                  "severity": "Low",
                  "title": "Man in the middle attack",
                  "type": "Information disclosure",
                  "mitigation": "Enforce an encrypted connection at the DB server",
                  "description": "An attacker could intercept the DB queries in transit and obtain sensitive information, such as DB credentials, query parameters or query results (is unlikely since the data flow is over a private network).",
                  "modelType": "STRIDE",
                  "id": "72b9712b-2c08-40b1-aea6-57604e82f5f4"
                }
              ],
              "isTrustBoundary": false
            },
            "id": "2640a9c1-0815-45d6-ba26-2bee61f90635",
            "source": {
              "cell": "4f9ecf52-ec3e-4258-942c-742e2df220bb"
            },
            "target": {
              "cell": "ea29d570-adc5-4a89-8789-8b26af9c8a96"
            },
            "vertices": [
              {
                "x": 466,
                "y": 347
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1,
                "targetMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "Web Response (HTTP/S)",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": 0.5
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web Response",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": true,
              "protocol": "HTTP/S",
              "threats": [
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "title": "Data flow should use HTTP/S",
                  "type": "Information disclosure",
                  "description": "These responses are over the public internet and could be intercepted by an attacker.",
                  "mitigation": "The requests should require HTTP/S. This will provide confidentiality and integrity. HTTP should not be supported.",
                  "modelType": "STRIDE",
                  "id": "2cba4931-e49c-4d4c-ad7c-d2de4875f15a"
                }
              ],
              "isTrustBoundary": false
            },
            "id": "6c0c9458-a41b-4d41-9950-e70394e5a697",
            "source": {
              "cell": "e825227b-d35f-4cee-883b-92a10a3b83a7"
            },
            "target": {
              "cell": "8d7b0f97-6e4f-453d-95ee-8890baea4f12"
            },
            "vertices": [
              {
                "x": 90,
                "y": 170
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1,
                "targetMarker": {
                  "name": "block"
                },
                "strokeDasharray": "2 2"
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "Read web app config",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": 0.5
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Read web app config",
              "description": "",
              "outOfScope": true,
              "reasonOutOfScope": "This data flow represents a read from the file system",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [],
              "isTrustBoundary": false
            },
            "id": "54717a7d-47ae-440a-9ec6-f85f8ba0def9",
            "source": {
              "cell": "1677fe5b-b403-488e-a270-56494842cd9d"
            },
            "target": {
              "cell": "e825227b-d35f-4cee-883b-92a10a3b83a7"
            },
            "vertices": [
              {
                "x": 157,
                "y": 292
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1,
                "targetMarker": {
                  "name": "block"
                },
                "strokeDasharray": "2 2"
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "Read worker config",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": 0.5
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Read worker config",
              "description": "",
              "outOfScope": true,
              "reasonOutOfScope": "This data flow represents a read from the file system",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [],
              "isTrustBoundary": false
            },
            "id": "62dd64c0-e9a2-4301-a255-da4c4e448c80",
            "source": {
              "cell": "a78cb4c9-4773-467e-9f4c-479b0c44debb"
            },
            "target": {
              "cell": "ea29d570-adc5-4a89-8789-8b26af9c8a96"
            },
            "vertices": [
              {
                "x": 810,
                "y": 310
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1,
                "targetMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "Queries",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": 0.5
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Queries",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [],
              "isTrustBoundary": false
            },
            "id": "ef3b8f38-1980-4ac1-8f77-fe92dccef89d",
            "source": {
              "cell": "e825227b-d35f-4cee-883b-92a10a3b83a7"
            },
            "target": {
              "cell": "4f9ecf52-ec3e-4258-942c-742e2df220bb"
            },
            "vertices": [
              {
                "x": 311,
                "y": 324
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1,
                "targetMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "Web App Query\nResults",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": 0.5
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web App Query\nResults",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [],
              "isTrustBoundary": false
            },
            "id": "ab8333eb-c690-4793-a4aa-f98d79305d9c",
            "source": {
              "cell": "4f9ecf52-ec3e-4258-942c-742e2df220bb"
            },
            "target": {
              "cell": "e825227b-d35f-4cee-883b-92a10a3b83a7"
            },
            "vertices": [
              {
                "x": 377,
                "y": 280
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "Worker Queries",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Worker Queries",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [],
              "isTrustBoundary": false
            },
            "id": "5f6cf18c-2f5f-4388-819c-23515435f461",
            "source": {
              "cell": "ea29d570-adc5-4a89-8789-8b26af9c8a96"
            },
            "target": {
              "cell": "4f9ecf52-ec3e-4258-942c-742e2df220bb"
            },
            "vertices": [
              {
                "x": 560,
                "y": 400
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "attrs": {
              "line": {
                "targetMarker": "",
                "sourceMarker": ""
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  },
                  "text": {
                    "text": ""
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "73015484-99de-49af-ab02-c9fa0f6e6cf9",
            "source": {
              "x": 350,
              "y": 10
            },
            "target": {
              "x": 810,
              "y": 150
            },
            "vertices": [
              {
                "x": 333,
                "y": 117
              },
              {
                "x": 432,
                "y": 180
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "attrs": {
              "line": {
                "targetMarker": "",
                "sourceMarker": ""
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  },
                  "text": {
                    "text": ""
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "9af49fb8-b6a0-453d-a24d-d10e6fde02bd",
            "source": {
              "x": 230,
              "y": 520
            },
            "target": {
              "x": 660,
              "y": 510
            },
            "vertices": [
              {
                "x": 320,
                "y": 280
              },
              {
                "x": 590,
                "y": 250
              },
              {
                "x": 660,
                "y": 350
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "attrs": {
              "line": {
                "targetMarker": "",
                "sourceMarker": ""
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  },
                  "text": {
                    "text": ""
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "56a6aaee-8f6f-47f6-9e69-2210afc2fef7",
            "source": {
              "x": 40,
              "y": 240
            },
            "target": {
              "x": 290,
              "y": 10
            },
            "vertices": [
              {
                "x": 276,
                "y": 149
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1,
                "targetMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "Web Request (HTTP/S)",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": 0.5
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web Request",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": true,
              "protocol": "HTTP/S",
              "threats": [
                {
                  "status": "Mitigated",
                  "severity": "High",
                  "title": "Data flow should use HTTP/S",
                  "type": "Information disclosure",
                  "description": "These requests are made over the public internet and could be intercepted by an attacker.",
                  "mitigation": "The requests should require HTTP/S. This will provide confidentiality and integrity. HTTP should not be supported.",
                  "modelType": "STRIDE",
                  "id": "79cbaf10-e5a2-4fd6-9818-7f180a113938"
                }
              ],
              "isTrustBoundary": false
            },
            "id": "03132f4e-78e0-47ce-b594-47a941ccea09",
            "source": {
              "x": 180,
              "y": 70
            },
            "target": {
              "cell": "e825227b-d35f-4cee-883b-92a10a3b83a7"
            },
            "vertices": [
              {
                "x": 190,
                "y": 80
              },
              {
                "x": 190,
                "y": 110
              },
              {
                "x": 210,
                "y": 130
              }
            ]
          },
          {
            "position": {
              "x": 760,
              "y": 60.00000000000041
            },
            "size": {
              "width": 310,
              "height": 70
            },
            "attrs": {
              "text": {
                "text": "A Demo Threat Model\nshowing an example web application,\nwith a queue-decoupled background process"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 11,
            "id": "228111c0-fb5e-48fa-96d7-46a8d65dc7af",
            "data": {
              "type": "tm.Text",
              "name": "A Demo Threat Model\nshowing an example web application,\nwith a queue-decoupled background process",
              "hasOpenThreats": false
            }
          }
        ],
        "version": "2.3.0",
        "title": "Main Request Data Flow",
        "description": "",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "diagramType": "STRIDE",
        "id": 0
      }
    ],
    "diagramTop": 0,
    "reviewer": "",
    "threatTop": 0
  },
  "version": "2.5.0"
}